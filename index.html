<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <title>Calculator</title>
    <script>
    function preventback(){
      window.history.forward();
    }
    setTimeout("preventback()", 0);
    window.onunload=function(){ null };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
  </head>
  <body style="background-color: rgb(8, 252, 232);">
    <div class="mt-2" style="margin-left: 10px;">
        <button class="btn btn-info" onclick="Logout()">Logout</button>
    </div>
    <div class="container">
        <div class="row">
            <div class="mt-3 col-md-6 bg-info border border-dark rounded">
                <h5 class="text-center mt-1">Calculater</h5>
                <p class="text-center">Welcome <script>
                    var user=localStorage.getItem("username");
                    if(user==null){
                        alert("Please login your account");
                        window.location.href="student-login";
                    }else{
                        document.write(localStorage.getItem("username"));
                    }
                </script></p>
                <p class="text-center text-white bg-danger col-md-5 rounded mx-auto" id="error"></p>
                <div class="col-md-5 mx-auto mt-3">
                    <label for="">Enter first no</label>
                    <input type="text" id="number1" class="form-control" required placeholder="one to nine">
                </div> 
                <div class="col-md-5 mx-auto mt-3">
                    <label for="">Enter oprator</label>
                    <input type="text" id="opration" class="form-control" required placeholder="plus,minus,multiple,divide">
                </div> 
                <div class="col-md-5 mx-auto mt-3">
                    <label for="">Enter second no</label>
                    <input type="text" id="number2" class="form-control" required placeholder="one to nine">
                </div> 
                <div class="col-md-5 mx-auto mt-3">
                    <label for="">Result</label>
                    <input type="number" id="result" readonly class="form-control" required>
                </div> 
                <div class="col-md-12 text-center mt-3 mb-3">
                    <button class="btn btn-primary" onclick="getValue()" type="button">Enter</button>
                    <button class="btn btn-danger" type="reset">Cancel</button>
                </div> 
            </div>
            <div class="col-md-6 border border-dark rounded mt-3 bg-info">
                <h2 style="text-align: center;">Logs</h2>
                <div class="row border border-dark rounded">
                    <div class="col-md-3 text-center" style="background-color: #ffdc5c;">First no</div>
                    <div class="col-md-3 text-center" style="background-color: #38b7ff;">Oprator</div>
                    <div class="col-md-3 text-center" style="background-color: #ff38ee;">Second no</div>
                    <div class="col-md-3 text-center" style="background-color: #ff914d;">Result</div>
                </div>
                <div id="showUsers" class="border border-dark col-md-12 text-center" style="width: 104.5%; margin-left: -12px;"></div>
            </div>
        </div>
    </div>
</body>
<script>
    var url=window.location.search;
    var value=new URLSearchParams(url);
    var username=value.get('user');
    var user=localStorage.getItem("username");
    if(username==user){
        function getValue(){
            var number1=document.getElementById('number1').value;
            var number2=document.getElementById('number2').value;
            var opration=document.getElementById('opration').value;
            var number1=number1.toLowerCase();
            var number2=number2.toLowerCase();
            var opration=opration.toLowerCase();
            var number1=number1.trim();
            var number2=number2.trim();
            var opration=opration.trim();
           
            if(number1=="" || number2=="" || opration ==""){
                document.getElementById('error').innerText="Empty field is not allowed!";
            }else{
                if(number1=="zero"){
                function number1(func){
                    return func ? func(0):0;
                };
            }else if(number1=="one"){
                function number1(func){
                    return func ? func(1):1;
                };
            }else if(number1=="two"){
                function number1(func){
                    return func ? func(2):2;
                };
            }else if(number1=="three"){
                function number1(func){
                    return func ? func(3):3;
                };
            }else if(number1=="four"){
                function number1(func){
                    return func ? func(4):4;
                };
            }else if(number1=="five"){
                function number1(func){
                    return func ? func(5):5;
                };
            }else if(number1=="six"){
                function number1(func){
                    return func ? func(6):6;
                };
            }else if(number1=="seven"){
                function number1(func){
                    return func ? func(7):7;
                };
            }else if(number1=="eight"){
                function number1(func){
                    return func ? func(8):8;
                };
            }else if(number1=="nine"){
                function number1(func){
                    return func ? func(9):9;
                };
            }else{
                document.getElementById('error').innerText="Enter valid number in text format!";
            }
            if(number2=="zero"){
                function zero(func){
                    return func ? func(0):0;
                };
            }else if(number2=="one"){
                function number2(func){
                    return func ? func(1):1;
                };
            }else if(number2=="two"){
                function number2(func){
                    return func ? func(2):2;
                };
            }else if(number2=="three"){
                function number2(func){
                    return func ? func(3):3;
                };
            }else if(number2=="four"){
                function number2(func){
                    return func ? func(4):4;
                };
            }else if(number2=="five"){
                function number2(func){
                    return func ? func(5):5;
                };
            }else if(number2=="six"){
                function number2(func){
                    return func ? func(6):6;
                };
            }else if(number2=="seven"){
                function number2(func){
                    return func ? func(7):7;
                };
            }else if(number2=="eight"){
                function number2(func){
                    return func ? func(8):8;
                };
            }else if(number2=="nine"){
                function number2(func){
                    return func ? func(9):9;
                };
            }else{
                document.getElementById('error').innerText="Enter valid number in text format!";
            }
            if(opration=="plus"){
                function opration(b){
                    return function(a){
                        return b+a;
                    };
                };
            }else if(opration=="minus"){
                function opration(b){
                    return function(a){
                        return b-a;
                    };
                };
            }else if(opration=="multiple"){
                function opration(b){
                    return function(a){
                        return a*b;
                    };
                };
            }else if(opration=="divide"){
                function opration(b){
                    return function(a){
                        return b/a;
                    };
                };
            }else{
                document.getElementById('error').innerText="Enter valid opration in text format!";
            }
            document.getElementById('result').value=Math.trunc(number2(opration(number1())));
            result=Math.trunc(number2(opration(number1()))); 
            var no1=document.getElementById("number1").value;
            var no2=document.getElementById("number2").value;
            var oprations=document.getElementById("opration").value;
            var cal_record=new Array();
             cal_record=JSON.parse(localStorage.getItem("calculate"))?JSON.parse(localStorage.getItem("calculate")):[];
            if(cal_record){
                username=localStorage.getItem("username");
                cal_record.push({
                        "username":username,
                        "number1":no1,
                        "number2":no2,
                        "oprator":oprations,
                        "result":result
                });
                localStorage.setItem("calculate",JSON.stringify(cal_record));
            }else{
                alert("Something went wrong!");
                window.location.href="student-login";
            }
        }
    }
    }else{
        alert("Something went wrong!");
        window.location.href="student-login";
    }
    function Logout(){
        localStorage.removeItem("username");
        localStorage.removeItem("email");
        window.location.href="student-login";
    }
    document.getElementById("showUsers").innerHTML="";
    var cal_record=new Array();
    cal_record=JSON.parse(localStorage.getItem("calculate"))?JSON.parse(localStorage.getItem("calculate")):[];
    if(cal_record)
    {
      for(let i=0;i<cal_record.length;i++)
      {
        if(cal_record[i].username==username){
            let addDiv=document.createElement('div');
            addDiv.className="row";
            addDiv.innerHTML='  <div class="col-md-3 mt-2">'+cal_record[i].number1+'</div><div class="col-sm-3 mt-2">'+cal_record[i].oprator+'</div><div class="col-md-3 mt-2">'+cal_record[i].number2+'</div><div class="col-md-3 mt-2">'+cal_record[i].result+'</div>';
            document.getElementById("showUsers").appendChild(addDiv); 
        } 
      }
    }

</script>
</html>